<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<title>Granos</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport">

<!-- Font Awesome -->
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/all.min.css"
	rel="stylesheet">
<!-- Libraries Stylesheet -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
<link href="lib/owlcarousel/assets/owl.carousel.min.css"
	rel="stylesheet">
<link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">
<!-- Customized Bootstrap Stylesheet -->
<link href="css/style.css" rel="stylesheet">
<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script async defer
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyATeoZ7fWCS8U8qhMAa-Z2uqCYaPbmXpdU&libraries=marker"></script>
</head>
<body>
	<!-- Navbar Start -->
	<div class="container-fluid bg-white position-relative">
		<nav
			class="navbar navbar-expand-lg bg-white navbar-light py-3 py-lg-0">
			<a href="index" class="navbar-brand text-secondary">
				<h1 class="display-4 ">
					<span>G</span><span style="color: #ffcc00;">r</span><span>anos</span>
				</h1>
			</a>
			<button type="button" class="navbar-toggler"
				data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarCollapse">
				<div class="navbar-nav ml-auto py-0 pr-3">
					<a href="home" class="nav-item nav-link active" th:text="#{home}">Home</a> <a
						href="calendar" class="nav-item nav-link" th:text="#{calendar}">Calendar</a> <a
						href="attendance" class="nav-item nav-link" th:text="#{attendance}">Attendance</a> <a
						href="payroll" class="nav-item nav-link" th:text="#{payroll}">Payroll</a> <a
						href="balances" class="nav-item nav-link" th:text="#{balances}">Balances</a> <a
						href="administrator" class="nav-item nav-link circle-background"
						th:classappend="${user.jobId != 1} ? 'disabled'"> <span
						class="border border-warning rounded-lg p-3"
						th:text="${user.character.nameEn}"></span>
					</a> <a href="logout" class="nav-item nav-link" th:text="#{logout}">Logout</a>
				</div>
			</div>
		</nav>
	</div>
	<!-- Navbar End -->


	<!-- Header Start -->
	<div class="container-fluid bg-primary py-4">
		<div class="row mx-0 align-items-center">
			<div class="col-lg-4 px-md-5 text-center">
				<button type="button"
					class="btn btn-rainbow text-uppercase mt-1 py-3 px-5"
					data-bs-toggle="modal" data-bs-target="#popup1" th:text="#{punch}">Punch</button>
			</div>
			<div class="col-lg-4 px-0 text-center">
				<h1 class="display-4 mt-3" th:text="'Hi! '+${user.nameEn}"></h1>
			</div>
			<div class="col-lg-4 px-0 text-center">
				<img class="img-fluid mt-3 mt-lg-0" src="/avatar" alt="User Avatar">
			</div>
		</div>
	</div>
	<!-- Header End -->
	<!-- Services Start -->
	<div class="container-fluid py-3">
		<div class="container-fluid pt-3 pb-3">
			<div class="row">
				<div class="col-lg-3 mb-2">
					<div class="service-item rounded p-5 mb-4">
						<i class="fa fa-3x fa-calendar-check text-primary mb-4"></i>
						<h4 class="text-uppercase mb-4">
							TODAY<span class="d-block text-body">Day Off</span>
						</h4>
						<p class="m-0">09:00-18:00</p>
						<p class="m-0">Regular day off</p>
					</div>
				</div>
				<div class="col-lg-3 mb-2">
					<div class="service-item rounded p-5 mb-4">
						<i class="fa fa-3x fa-calendar text-primary mb-4"></i>
						<h4 class="text-uppercase mb-4">
							MON 30<span class="d-block text-body">WORK</span>
						</h4>
						<p class="m-0">09:00-18:00</p>
						<p class="m-0">morning shift</p>
					</div>
				</div>
				<div class="col-lg-3 mb-2">
					<div class="service-item rounded p-5 mb-4">
						<i class="fa fa-3x fa-calendar text-primary mb-4"></i>
						<h4 class="text-uppercase mb-4">
							TUE 31<span class="d-block text-body">WORK</span>
						</h4>
						<p class="m-0">09:00-18:00</p>
						<p class="m-0">morning shift</p>

					</div>
				</div>
				<div class="col-lg-3 mb-2">
					<div class="service-item rounded p-5 mb-4">
						<i class="fa fa-3x fa-calendar text-primary mb-4"></i>
						<h4 class="text-uppercase mb-4">
							WED 01<span class="d-block text-body">WORK</span>
						</h4>
						<p class="m-0">09:00-18:00</p>
						<p class="m-0">morning shift</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="popup1" class="modal fade" aria-labelledby="exampleModalLabel"
		tabindex="-1" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLabel" th:text="#{workLocation}">Work Location</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div id="map" style="height: 250px; width: 100%;"></div>
				</div>
			</div>
		</div>
	</div>
	<!-- Services End -->
	<!-- JavaScript Libraries -->
	<!--===============================================================================================-->
	<script src="lib/easing/easing.min.js"></script>
	<script src="lib/waypoints/waypoints.min.js"></script>
	<script src="lib/owlcarousel/owl.carousel.min.js"></script>
	<script src="lib/isotope/isotope.pkgd.min.js"></script>
	<script src="lib/lightbox/js/lightbox.min.js"></script>
	<script>
		// 初始化地图
		function initMap(lat, lng) {
			let location = {
				lat : lat,
				lng : lng
			};
			var map = new google.maps.Map($('#map')[0], {
				zoom : 18, // 地图缩放级别
				center : location, // 使用獲取的緯度和經度
				mapId : "DEMO_MAP_ID",
				disableDefaultUI : true, // 禁用所有默認控件
				zoomControl : false, // 禁用縮放控件
				draggable : false, // 禁用地圖移動
				scrollwheel : false, // 禁用滾輪縮放
				disableDoubleClickZoom : true
			// 禁用雙擊縮放
			});
			// 創建圓形
			var circle = new google.maps.Circle({
				strokeColor : '#FF0000',
				strokeOpacity : 0.8,
				strokeWeight : 2,
				fillColor : '#FF0000',
				fillOpacity : 0.35,
				map : map,
				center : location, // 圓形中心點
				radius : 60
			// 半徑（以米為單位）
			});
			// 在当前位置添加标记
			var marker = new google.maps.marker.AdvancedMarkerElement({
				position : location,
				map : map,
				title : "Here we are",
			});
		}

		// 获取用户的地理位置
		function getLocation() {
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(function(position) {
					let lat = position.coords.latitude;
					let lng = position.coords.longitude;
					// 调用地图函数，传递经纬度
					initMap(lat, lng);
				}, function(error) {
					console.error('Error getting location:', error);
				}, {
					enableHighAccuracy : true,
					timeout : 5000, // 5 秒超時
					maximumAge : 0
				// 不使用緩存
				});
			} else {
				console.error('Geolocation is not supported by this browser.');
			}
		}

		// 監聽 Popup 顯示事件
		$('#popup1').on('show.bs.modal', function(e) {
			getLocation();
		});
	</script>
	<!-- Template Javascript -->
	<script src="js/main.js"></script>
</body>
</html>